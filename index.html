<!DOCTYPE html>
<html>

<head>
    <title>Calendrier Poste</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" href="style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://apis.google.com/js/api.js"></script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
 

</head>

<body>
    <h1>Calendrier des Postes</h1>
    <label for="Jour">Sélectionnez une date :</label>
    <select id="Jour" onchange="afficherPoste()"></select>
    <br>
    <label for="posteInput">Poste :</label>
    <input type="text" id="posteInput" readonly>

    <script>
        var correspondances = {};

        function start() {
            gapi.client.init({
                'apiKey': 'AIzaSyAIRpStG7VNS7XKpYmxunpO5hIsdZ_9d0E',
                'discoveryDocs': ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
            }).then(function () {
                console.log('API initialized');
                chargerCorrespondances();
            }, function (error) {
                console.log('Error initializing API', error);
            });
        }

              function chargerCorrespondances() {
            var spreadsheetId = "1gm-uxD8_wMvs7B12o9-hNKpehVwriWNepvVS1QxplAw"; // ID de la feuille de calcul
            var range = "Sheet1!B2:D"; // Plage de données dans la feuille de calcul

            gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: spreadsheetId,
                range: range,
            }).then(function(response) {
                var values = response.result.values;
                correspondances = {};
                if (values && values.length > 0) {
                    for (var i = 0; i < values.length; i++) {
                        var row = values[i];
                        correspondances[row[0]] = row[2]; // Utilisez le bon index pour correspondre à vos données
                    }
                }
                // Mettez à jour la liste déroulante après avoir chargé les correspondances
                mettreAJourListeDeroulante();
            }, function(response) {
                console.log('Erreur : ' + response.result.error.message);
            });
        }

        function afficherPoste() {
            var dateSelectionnee = document.getElementById("Jour").value;
            var posteInput = document.getElementById("posteInput");

            if (correspondances.hasOwnProperty(dateSelectionnee)) {
                posteInput.value = correspondances[dateSelectionnee];
            } else {
                posteInput.value = "Aucune information trouvée pour cette date";
            }
        }

        // Fonction pour mettre à jour la liste déroulante avec les dates
        function mettreAJourListeDeroulante() {
            var selectJour = document.getElementById("Jour");

            // Ajoutez les dates à la liste déroulante
            for (var date in correspondances) {
                var option = document.createElement("option");
                option.value = date;
                option.text = date;
                selectJour.add(option);
            }
        }
      
   window.onload = function() {
            gapi.load('client', start);
        }; 
      
        



     
    </script>
</body>

</html>
